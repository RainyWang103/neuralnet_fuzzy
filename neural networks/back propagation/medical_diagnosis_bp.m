


% medical diagonosis BP
% Symptons and Lab Test Results    |    Five diseases           
%
% s1  s2  s3  s4  r1  r2  r3  r4   |    d1  d2  d3  d4  d5
clear all, close all

Trainset=[
    0.9000    0.2000    0.1000    0.0600    0.8500    0.0500    0.1200         0       1     0     0     0     0
    0.1500    0.1000    0.8900    0.7800    0.8600         0    0.1100         0       0     0     0     0     1
    0.1300    0.1900         0    0.1000         0    0.3100         0    0.8800       1     0     0     0     0
    0.1400         0    0.9500    0.8500    0.1400    0.7800    0.9600    0.0900       0     1     1     0     0
    0.0700    0.1500    0.0300    0.8500    0.1000    0.9600    0.0800         0       0     1     0     0     0
    0.1000         0    0.9500    0.1000    0.0700    0.0800    0.9300         0       0     0     1     0     0
         0    0.0300         0    0.1200         0    0.0900    0.9100    0.8800       0     0     1     0     0
         0    0.9100    0.0800    0.1200    0.9500         0    0.1000         0       0     0     0     1     0
    0.9300    0.1300    0.1100    0.3100    0.1000    0.8500    0.0800         0       0     0     0     1     0
    0.0900         0    0.9500    0.8500    0.1000    0.0800    0.1000         0       1     0     0     0     0
    0.1000    0.0200    0.8500         0    0.9300    0.0600         0    0.8900       0     0     0     0     1
    0.1500    0.0800    0.8800    0.9500         0    0.1000    0.1000    0.1400       1     0     0     0     0
    0.9100    0.8800    0.0900    0.1000         0    0.0600    0.0500         0       0     1     0     0     0
    0.9000    0.0900    0.9500         0    0.9100    0.8800         0    0.9500       0     0     0     1     1
    0.8500    0.9200    0.3200    0.1000         0    0.2100    0.1000    0.8100       1     1     0     0     0
    0.0800    0.1000    0.8800    0.8100         0    0.7900    0.9500         0       0     1     1     0     0
    0.7800    0.0500    0.1000    0.0300    0.8500    0.0500    0.2000    0.1700       1     0     0     0     0
    0.1300         0    0.9900         0    0.8600    0.2700    0.1100    0.7800       0     0     0     0     1
    0.1000    0.0800    0.1200    0.1400    0.2100    0.1000    0.0700    0.8800       1     0     0     0     0
    0.7800    0.8500    0.1100    0.2300         0    0.1000    0.1300    0.0800       0     1     0     0     0
    0.2200    0.1700    0.1600    0.9500    0.1000    0.8800    0.2100         0       0     1     0     0     0
    0.2000    0.2200    0.8500         0    0.2500    0.0900    0.8600    0.0600       0     0     1     0     0
    0.1000         0    0.1000         0    0.1700    0.1300    0.8500    0.9300       0     0     1     0     0
         0    0.9500    0.0400    0.0900    0.9400    0.1000    0.0600    0.0700       0     0     0     1     0
    0.9100    0.1500    0.1300    0.2100         0    0.8500    0.1000    0.1300       0     0     0     1     0
    0.2000    0.9200    0.8500         0    0.3100    0.0500    0.1600    0.1100       0     0     0     0     1
    0.1000         0    0.8800    0.9500    0.7800    0.1200    0.1200    0.2100       0     0     0     0     1
    0.9200    0.1000    0.9100    0.0300    0.9500    0.9400    0.0600    0.7900       0     0     0     1     1
    0.8800    0.9400         0    0.1000    0.1400         0    0.0400    0.9200       1     1     0     0     0
    0.1200    0.9100    0.9500         0    0.0500    0.0600    0.1500         0       0     0     0     0     1
];


%--TRAINING-----------
xinput=Trainset(:,[1:8])';
xoutput=Trainset(:,[9:13])';
disp('Start training')

Num_Nodes = 5; % Number of hidden nodes
net=newff(minmax(xinput),[Num_Nodes 5],{'logsig' 'purelin' },'trainlm')
%
net.trainParam.epochs = 10;
net.trainParam.show = 1;

net=train(net,xinput,xoutput)
disp('Finished training')

%--TESTING-----------
tinput=[

    0.2100    0.1200    0.9800    0.7000    0.1400    0.2300    0.3100    0.1000
 
    0.9500    0.7000    0.1200    0.1400         0    0.1900    0.1200    0.1000
 
    0.2000    0.1700    0.9100    0.0500         0    0.1800    0.8700    0.1500
 
 
    0.9300    0.2200         0    0.1800    0.0500    0.7700    0.1500    0.1700

 
    0.2300    0.1400    0.8800    0.7000    1.0000         0    0.1500    0.0500

    0.1500    0.1900    0.9500    0.7400    0.3100    0.7000    0.8900    0.1400
]';
anstest=sim(net,tinput)'
round(anstest)

